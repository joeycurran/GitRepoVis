{"ast":null,"code":"'use strict';\n\nvar bn2num = require('./lib/bn-to-num');\n\nvar ctz = require('./lib/ctz');\n\nmodule.exports = roundRat; // Round a rational to the closest float\n\nfunction roundRat(f) {\n  var a = f[0];\n  var b = f[1];\n\n  if (a.cmpn(0) === 0) {\n    return 0;\n  }\n\n  var h = a.abs().divmod(b.abs());\n  var iv = h.div;\n  var x = bn2num(iv);\n  var ir = h.mod;\n  var sgn = a.negative !== b.negative ? -1 : 1;\n\n  if (ir.cmpn(0) === 0) {\n    return sgn * x;\n  }\n\n  if (x) {\n    var s = ctz(x) + 4;\n    var y = bn2num(ir.ushln(s).divRound(b));\n    return sgn * (x + y * Math.pow(2, -s));\n  } else {\n    var ybits = b.bitLength() - ir.bitLength() + 53;\n    var y = bn2num(ir.ushln(ybits).divRound(b));\n\n    if (ybits < 1023) {\n      return sgn * y * Math.pow(2, -ybits);\n    }\n\n    y *= Math.pow(2, -1023);\n    return sgn * y * Math.pow(2, 1023 - ybits);\n  }\n}","map":null,"metadata":{},"sourceType":"script"}